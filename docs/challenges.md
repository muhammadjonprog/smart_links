## Сложности проекта и способы их решения

### 1. Конфликт правил и порядок обработки
**Проблема:** необходимо определить, какое правило применять, если совпадают несколько.  
**Решение:** введена сортировка правил по приоритету (`sortedByDescending { it.priority }`) и выбор первого совпавшего правила.

---

### 2. Расширяемость без изменения существующего кода
**Проблема:** добавление новых правил не должно требовать изменения текущей логики.  
**Решение:** реализован интерфейс `Rule` и декларативный DSL (`smartLink { ... }`), позволяющий добавлять новые правила без модификации существующих классов.

---

### 3. Дополнительные действия до и после обработки
**Проблема:** нужно выполнять логирование или аналитику, не вмешиваясь в основную логику RuleEngine.  
**Решение:** добавлен слой `Middleware`, аналогичный interceptor-подходу, позволяющий выполнять действия до и после обработки правил.

---

### 4. Обеспечение высокого процента покрытия тестами
**Проблема:** требовалось достичь покрытия тестами **не менее 90%**.  
**Решение:** написаны модульные тесты для каждого типа правил и RuleEngine. Использован JaCoCo для автоматического подсчёта покрытия. Итоговое покрытие — **93%**.

---

### 5. Предсказуемость работы всей системы
**Проблема:** при нескольких совпавших условиях поведение должно быть стабильным и повторяемым.  
**Решение:** установлен чёткий алгоритм:
1) сортировать правила по приоритетам,
2) искать первое совпадающее,
3) выполнять только его,
4) в случае отсутствия совпадений применять `Default Rule`.

---
